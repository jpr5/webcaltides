<%#
  Find Nearby Stations Popover Partial

  Locals:
    - station_id: ID to search near (used as searchtext)
    - theme: Hash with :accent (color name), :text (text color class)
%>
<div x-data="{ showNearby: false, distanceUnit: window.unitUtils.getDistanceUnit() }"
     @units-changed.window="distanceUnit = window.unitUtils.getDistanceUnit()"
     class="mt-3 relative">
    <button
        @click="showNearby = !showNearby"
        class="text-xs text-slate-500 hover:text-<%= theme[:accent] %>-400 transition-colors"
    >
        Find nearby stations â†’
    </button>

    <div
        x-show="showNearby"
        x-cloak
        @click.away="showNearby = false"
        x-transition
        class="absolute left-0 bottom-full mb-2 p-3 bg-navy-900 border border-navy-700 rounded-xl shadow-xl z-50"
    >
        <form action="/" method="POST" class="flex items-center gap-2">
            <input type="hidden" name="searchtext" value="<%= station_id %>" />
            <input
                type="number"
                name="within"
                placeholder="10"
                class="w-16 px-2 py-1.5 bg-navy-800 border border-navy-700 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:border-<%= theme[:accent] %>-500"
            />
            <span class="text-slate-500 text-sm" x-text="distanceUnit"></span>
            <button
                type="submit"
                class="px-3 py-1.5 bg-<%= theme[:accent] %>-500 hover:bg-<%= theme[:accent] %>-400 rounded-lg text-sm <%= theme[:text] %> transition-colors"
            >
                Search
            </button>
        </form>
    </div>
</div>
